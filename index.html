<!DOCTYPE html>
<html>
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />

        <title>Sample using Babylon js</title>

        <!-- Babylon.js -->
        <script src="https://preview.babylonjs.com/gltf_validator.js"></script>
        <script src="https://preview.babylonjs.com/babylon.js"></script>
        <script src="https://preview.babylonjs.com/loaders/babylonjs.loaders.js"></script>
     
        <style>
         html, body { overflow: hidden; width: 100%; height: 100%; margin: 0; padding: 0; }

         #renderCanvas { width: 100%; height: 100%; touch-action: none; }
        </style>
    </head>
<body>
    <canvas id="renderCanvas"></canvas>

    <!--- GUI Display Creation Section: Follow this format -->
    $('body').append('<button id="button" style="position: absolute; right: 10px; top: 90px;">Play</button>');
    $('body').append('<button id="button" style="position: absolute; right: 10px; top: 100px;">Pause</button>');

    <script>
        var canvas = document.getElementById("renderCanvas");

        var createScene = function() {
            // Create scene
        	var scene = new BABYLON.Scene(engine);
            // Default Environment
            var environment =  scene.createDefaultEnvironment({ 
                    createSkybox: false,
                    createGround: true,
                    groundSize: 1000,
                    enableGroundShadow: true, 
                    groundYBias: 1 
            });

            // Skybox
            var skyMaterial = new BABYLON.StandardMaterial("skybox", scene);
                skyMaterial.backFaceCulling = false;
                skyMaterial.reflectionTexture = new BABYLON.CubeTexture("textures/skybox", scene);
                skyMaterial.reflectionTexture.coordinatesMode = BABYLON.Texture.SKYBOX_MODE;
                skyMaterial.diffuseColor = new BABYLON.Color3(0, 0, 0);
                skyMaterial.specularColor = new BABYLON.Color3(0, 0, 0);
            var skybox = BABYLON.MeshBuilder.CreateBox("skyBox", {size:1000.0}, scene);
               skybox.material = skyMaterial;

            // Audio Creation
            var isMusicPlaying = false;
            var music = new BABYLON.Sound("music", "guitar.mp3", scene, soundReady, {loop: true });

            console.log("can print things on here");
            
            function soundReady() {
                if (isMusicPlaying) {
                    console.log("Sound is being paused");
                    music.pause();
                    isMusicPlaying = false;
                }
                else {
                    console.log("Sound is being played");
                    music.play();
                    isMusicPlaying = true;
                }
            }

            // Audio Toggle on Spacebar (Convert later to WebVR button when interacting with object)
            window.addEventListener("keydown", function(evt) {
                // Press space key to toggle music
                if (evt.keyCode === 32) {
                    soundReady();
                }
            });

            // Enable VR
            var vrHelper = scene.createDefaultVRExperience({createDeviceOrientationCamera:false});
            vrHelper.enableTeleportation({floorMeshes: [environment.ground]});

            var box = BABYLON.Mesh.CreateBox("crate", 2, scene);
            box.material = new BABYLON.StandardMaterial("Mat", scene);
            box.position = new BABYLON.Vector3(10, 5, 0);
            music.attachToMesh(box);

            var lamp = BABYLON.SceneLoader.Append("./", "lamp.glb", scene, function (meshes) {    
                scene.createDefaultCameraOrLight(true, true, true);

            });    
            
        	return scene;
        };
               
        var engine = new BABYLON.Engine(canvas, true, { preserveDrawingBuffer: true, stencil: true });
        var scene = createScene();

        engine.runRenderLoop(function () {
            if (scene) {
                scene.render();
            }
        });

        // Resize
        window.addEventListener("resize", function () {
            engine.resize();
        });
    </script>
</body>
</html>